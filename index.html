<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BFDI's Night Shift</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: black; overflow: hidden; font-family: 'Courier New', monospace; }

        #game-container { position: relative; width: 100vw; height: 100vh; background: #000; }
        
        #office { width: 100%; height: 100%; background-size: cover; background-position: center; transition: filter 0.1s; }

        /* High Visibility Noise Overlay */
        #noise-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2000; pointer-events: none; opacity: 0.25; /* Higher Opacity */
            mix-blend-mode: screen;
        }

        /* Monitor Transition */
        #monitor {
            position: absolute; bottom: -110%; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 1000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: bottom 0.3s cubic-bezier(0.17, 0.84, 0.44, 1);
        }
        #monitor.active { bottom: 0; }

        #viewport { width: 85vw; height: 60vh; border: 4px solid white; background-size: cover; background-position: center; }
        
        /* GUI */
        #time-display { position: absolute; top: 15px; left: 20px; color: white; font-size: 1.5rem; z-index: 50; }
        .btn { position: absolute; background: rgba(0,0,0,0.6); border: 2px solid white; color: white; padding: 20px; font-weight: bold; z-index: 40; border-radius: 8px;}
        #btn-l { left: 15px; bottom: 40%; }
        #btn-r { right: 15px; bottom: 40%; }
        #btn-cam { bottom: 15px; left: 50%; transform: translateX(-50%); width: 220px; text-align: center; }
        #btn-v { bottom: 15px; right: 15px; font-size: 0.7rem; }

        /* Jumpscare Animation Layered over Office */
        #js-container {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1500; overflow: hidden; pointer-events: none;
        }
        #js-img {
            width: 100%; height: 110%; object-fit: contain;
            position: absolute; bottom: -100%; left: 0;
            filter: blur(0px);
        }

        /* Fast Vertical Slide with Blur */
        .js-animate {
            animation: js-up 0.15s forwards, shake 0.05s infinite;
        }

        @keyframes js-up {
            0% { bottom: -100%; filter: blur(20px) brightness(2); }
            100% { bottom: 0%; filter: blur(0px) brightness(1); }
        }

        @keyframes shake {
            0% { transform: translate(5px, 5px); }
            50% { transform: translate(-5px, -10px); }
            100% { transform: translate(10px, 0px); }
        }

        /* Menu / Loading */
        #menu { position: absolute; top:0; left:0; width: 100%; height: 100%; background: #000; z-index: 3000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .blink { animation: bl 0.4s infinite; color: red !important; border-color: red !important; }
        @keyframes bl { 50% { opacity: 0.2; } }
    </style>
</head>
<body>

    <div id="game-container">
        <canvas id="noise-overlay"></canvas>
        <div id="time-display">12 AM</div>
        <div id="office"></div>

        <button id="btn-l" class="btn" ontouchstart="lt('l')" ontouchend="lt('o')">LIGHT L</button>
        <button id="btn-r" class="btn" ontouchstart="lt('r')" ontouchend="lt('o')">LIGHT R</button>
        <button id="btn-cam" class="btn" onclick="openM()">CAMERAS</button>
        <button id="btn-v" class="btn" onclick="rv()">RESET VENT</button>

        <div id="monitor">
            <button style="position:absolute; top:20px; right:20px; color:red; border:2px solid red; background:black; padding:10px;" onclick="closeM()">CLOSE</button>
            <div id="viewport"></div>
            <div style="margin-top:15px; display:flex; gap:10px;">
                <button class="btn" style="position:static" onclick="sw('w')">WEST</button>
                <button class="btn" style="position:static" onclick="sw('c')">CORNER</button>
                <button class="btn" style="position:static" onclick="sw('e')">EAST</button>
            </div>
        </div>

        <div id="js-container">
            <img id="js-img" src="">
        </div>
    </div>

    <div id="menu">
        <h1 style="color:red; font-size: 2.5rem;">BFDI's Night Shift</h1>
        <h2 style="color:red; font-size: 1rem;">Five Nights at beefydies</h2>
        <br>
        <button id="start-btn" class="btn" style="position:static" onclick="start()">PLAY NIGHT</button>
        <p id="load-msg" style="color:white; display:none; margin-top:20px;">PRE-LOADING ASSETS...</p>
    </div>

    <audio id="sc" src="https://s134-isny.freeconvert.com/task/694957662732b0f98d9b808f/FNAF_%20Jumpscare%20(FNAF%206)%20-%20Gaming%20Sound%20Effect%20(HD).mp3"></audio>

    <script>
        const urls = {
            off: 'https://img.sanishtech.com/u/1bd9cdabc392ccd45cf44ed4e71e190e.png',
            offL: 'https://img.sanishtech.com/u/ab331bacb0efede06a458b12a2c7069d.png',
            offR: 'https://img.sanishtech.com/u/2482cef9496b3b79ec63fe5658b729c3.png',
            wE: 'https://img.sanishtech.com/u/1a88fb87009e264607856e4d084ce2ac.png',
            wF: 'https://img.sanishtech.com/u/790120301d63d6ba0d06edf3926f0fc8.png',
            wL: 'https://img.sanishtech.com/u/1491c1ef0807f535661c3607d819c1f8.png',
            cE: 'https://img.sanishtech.com/u/12bc819aaae99daf4c5b28486e2224ef.png',
            cG: 'https://img.sanishtech.com/u/7c814709433df313776004af8ad71350.png',
            eE: 'https://img.sanishtech.com/u/63b6a58856dac190eb88c695bc35b001.png',
            jsf: 'https://img.sanishtech.com/u/a2ee57a87f0551b333dd6fc2caa2249d.png',
            jsl: 'https://img.sanishtech.com/u/f61807b6a324f38b5fb2ea741b22f2be.png',
            jsg: 'https://img.sanishtech.com/u/9b4aae19f2eb5a3f40bf116c2413c9aa.png',
            jsfl: 'https://img.sanishtech.com/u/99149ed62a0c1c16c0aab97efd269bf3.png'
        };

        let active = false, mon = false, vt = 25, hour = 0;
        let wCh = Math.random() > 0.5 ? 'f' : 'l', cCh = 'g';

        // PRELOADER: Loads images into browser cache immediately
        function preload() {
            Object.values(urls).forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }

        function start() {
            preload();
            document.getElementById('start-btn').style.display = 'none';
            document.getElementById('load-msg').style.display = 'block';
            setTimeout(() => {
                document.getElementById('menu').style.display = 'none';
                active = true;
                document.getElementById('office').style.backgroundImage = `url('${urls.off}')`;
                noise(); vLoop(); cLoop(); fLoop();
            }, 6000);
        }

        function openM() { if(!active) return; mon = true; document.getElementById('monitor').classList.add('active'); sw('w'); }
        function closeM() { 
            mon = false; document.getElementById('monitor').classList.remove('active'); 
            if(Math.random() < 0.4) {
                let a = null; if(wCh) {a=wCh; wCh=null;} else if(cCh) {a=cCh; cCh=null;}
                if(a) setTimeout(() => { if(active) jmp(a); }, 5000);
            }
        }

        function sw(c) {
            const v = document.getElementById('viewport');
            let i = urls.eE;
            if(c==='w') i = wCh==='f' ? urls.wF : (wCh==='l' ? urls.wL : urls.wE);
            else if(c==='c') i = cCh==='g' ? urls.cG : urls.cE;
            v.style.backgroundImage = `url('${i}')`;
        }

        function lt(s) {
            if(mon) return;
            document.getElementById('office').style.backgroundImage = `url('${s==='l'?urls.offL:(s==='r'?urls.offR:urls.off)}')`;
        }

        function rv() { vt = 25; document.getElementById('btn-v').classList.remove('blink'); document.getElementById('office').style.filter = "brightness(1)"; }
        
        function vLoop() {
            setInterval(() => {
                if(!active) return; vt--;
                if(vt <= 10) document.getElementById('btn-v').classList.add('blink');
                if(vt <= 0) document.getElementById('office').style.filter = "brightness(0)";
            }, 1000);
        }

        function cLoop() {
            setInterval(() => { if(!active) return; hour++; if(hour>=6) location.reload(); else document.getElementById('time-display').innerText = hour + " AM"; }, 60000);
        }

        function fLoop() { setInterval(() => { if(active && Math.random() < 0.1) jmp('fl'); }, 10000); }

        function jmp(n) {
            active = false;
            const container = document.getElementById('js-container');
            const img = document.getElementById('js-img');
            const s = document.getElementById('sc');
            
            // Turn office dark for better layered look
            document.getElementById('office').style.filter = "brightness(0.3) contrast(1.5)";
            
            img.src = urls['js'+n];
            container.style.display = 'block';
            img.classList.add('js-animate');
            
            s.loop = true; // LOOP SOUND
            s.play();
            
            setTimeout(() => location.reload(), 3000);
        }

        function noise() {
            const c = document.getElementById('noise-overlay'), x = c.getContext('2d');
            const r = () => { c.width = window.innerWidth/3; c.height = window.innerHeight/3; };
            window.addEventListener('resize', r); r();
            const d = () => {
                const id = x.createImageData(c.width, c.height), b = new Uint32Array(id.data.buffer);
                for(let i=0; i<b.length; i++) b[i] = Math.random() < 0.6 ? 0x35FFFFFF : 0; // Much higher density
                x.putImageData(id, 0, 0); requestAnimationFrame(d);
            }; d();
        }
    </script>
</body>
</html>
